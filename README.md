
    # üíº –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–∞–Ω–∫–æ–≤—Å–∫–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞
    
    ## üìå –¶–µ–ª—å
    –°–æ–∑–¥–∞—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—É—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è **–æ–±—Ä–∞–±–æ—Ç–∫–∏**, **—Ö—Ä–∞–Ω–µ–Ω–∏—è** –∏ **–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏** –¥–∞–Ω–Ω—ã—Ö –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –±–∞–Ω–∫–∞,  
    –∞ —Ç–∞–∫–∂–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –¥–∞—à–±–æ—Ä–¥–∞ –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–≤.
    
    ---
    
    ## ‚öôÔ∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
    
    | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
    |------------|-------------|
    | üêò **PostgreSQL** | –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤ |
    | ü™∂ **Apache Airflow** | –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ ETL (–∑–∞–≥—Ä—É–∑–∫–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö) |
    | üìä **Apache Superset** | –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞—à–±–æ—Ä–¥–æ–≤ |
    
    ---
    
    ## üöÄ –≠—Ç–∞–ø—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
    
    ### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
    
    #### 1.1 –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
    –ê—Ä–µ–Ω–¥—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ [Selectel](https://docs.selectel.ru/cloud/servers/create/create-server/).
    
    **–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
    
    | –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è | –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ |
    |------------|------------------------|----------------|
    | PostgreSQL | 1 CPU, 1 GB RAM | 2 CPU, 2 GB RAM |
    | Superset | 2 CPU, 2 GB RAM | 4 CPU, 4 GB RAM |
    | Airflow | 2 CPU, 2 GB RAM | 4 CPU, 4 GB RAM |
    | **–ò—Ç–æ–≥–æ (VM)** | ‚Äî | **8 CPU, 8 GB RAM, 30+ GB SSD** |
    
    > üí° –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, –æ–±—ä–µ–¥–∏–Ω–∏–≤ –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω—É —Å–µ—Ç—å,  
    > –ª–∏–±–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–∞–∂–¥—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –æ—Ç–¥–µ–ª—å–Ω–æ –Ω–∞ –º–∞—à–∏–Ω–µ.
    
    #### 1.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø–∞–∫–µ—Ç–æ–≤
    - PostgreSQL ‚Äî [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è Selectel](https://selectel.ru/blog/tutorials/how-to-install-and-use-postgresql-on-ubuntu-20-04/)
    - Apache Superset ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–π –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ —Å –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL
    - Apache Airflow ‚Äî —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–µ–∑ Docker (`pip install apache-airflow`)
    
    ---
    
    ### 2. –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ PostgreSQL
    
    #### 2.1 –ó–∞–≥—Ä—É–∑–∫–∞ –∏—Å—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    –î–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ S3-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ:
    
    - [credit_clients.csv](https://9c579ca6-fee2-41d7-9396-601da1103a3b.selstorage.ru/credit_clients.csv)
    - [–û–ø–∏—Å–∞–Ω–∏–µ –¥–∞—Ç–∞—Å–µ—Ç–∞ –Ω–∞ Kaggle](https://www.kaggle.com/datasets/shrutimechlearn/churn-modelling)
    
    #### 2.2 –°–æ–∑–¥–∞–Ω–∏–µ –ë–î –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
    1. –°–æ–∑–¥–∞–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö `bank_clients`
    2. –°–æ–∑–¥–∞–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `clients` –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ CSV  
    3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ PostgreSQL –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:
       - —Å–Ω–∞—Ä—É–∂–∏ (–¥–ª—è Airflow)
       - –≤–Ω—É—Ç—Ä–∏ docker-—Å–µ—Ç–∏ (–¥–ª—è Superset)
    
    –ü—Ä–∏–º–µ—Ä –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞:
    ```bash
    \copy clients FROM '/path/to/credit_clients.csv' DELIMITER ',' CSV HEADER;
    

* * *

### 3\. –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥–∞—à–±–æ—Ä–¥–∞ –≤ Apache Superset

#### 3.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ PostgreSQL –≤ Superset —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:  
**Data ‚Üí Databases ‚Üí + Database**

#### 3.2 –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–π

–°–æ–∑–¥–∞–π—Ç–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –¥–∞—à–±–æ—Ä–¥, –æ—Ç–æ–±—Ä–∞–∂–∞—é—â–∏–π –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏:

*   –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤ –ø–æ –ø–æ–ª—É
    
*   –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
    
*   –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ
    
*   –£—Ä–æ–≤–µ–Ω—å –¥–æ—Ö–æ–¥–∞ –∏ –∫—Ä–µ–¥–∏—Ç–Ω—ã–π —Ä–µ–π—Ç–∏–Ω–≥
    

* * *

### 4\. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Airflow

#### 4.1 DAG –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–°–æ–∑–¥–∞–π—Ç–µ DAG, –∫–æ—Ç–æ—Ä—ã–π **–∫–∞–∂–¥—ã–π —á–∞—Å** –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1.  **fetch\_new\_clients** ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∏–∑ S3  
    [–ü—Ä–∏–º–µ—Ä CSV —Ñ–∞–π–ª–∞](https://d382a55f-addf-48fd-a6cb-09b4305b5cf9.selstorage.ru/new_clients.csv)
    
2.  **insert\_new\_clients** ‚Äî –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ PostgreSQL
    
3.  **update\_dashboard** ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ Superset
    

> DAG –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É—Å—Ç–æ–π—á–∏–≤ –∫ –æ—à–∏–±–∫–∞–º: –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –æ–¥–Ω–æ–≥–æ —à–∞–≥–∞ –¥—Ä—É–≥–∏–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –ª–æ–º–∞—Ç—å—Å—è.

#### 4.2 –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã DAG

    @dag(schedule_interval="@hourly", start_date=datetime(2025, 10, 16))
    def client_update_pipeline():
        fetch_new_clients = PythonOperator(...)
        insert_new_clients = PythonOperator(...)
        refresh_superset = BashOperator(...)
    
        fetch_new_clients >> insert_new_clients >> refresh_superset
    

* * *

üìí –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É
--------------------------

1.  –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
    
        git clone https://github.com/<your-repo>/bank-analytics-platform.git
        cd bank-analytics-platform
        
    
2.  –ü–æ–¥–Ω–∏–º–∏—Ç–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ:
    
        docker-compose up -d
        
    
3.  –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Å–µ—Ä–≤–∏—Å–æ–≤:
    
    *   Airflow UI ‚Üí `http://<vm_ip>:8080`
        
    *   Superset ‚Üí `http://<vm_ip>:8088`
        
    *   PostgreSQL ‚Üí `psql -h <vm_ip> -U postgres`
        
4.  –ù–∞—Å—Ç—Ä–æ–π—Ç–µ DAG –∏ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
    

* * *

üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
---------------------------

*   **Airflow UI** ‚Äî –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ DAG –∏ –ª–æ–≥–æ–≤ –∑–∞–¥–∞—á
    
*   **Superset Logs** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
    
*   **PostgreSQL logs** ‚Äî –∫–æ–Ω—Ç—Ä–æ–ª—å –≤—Å—Ç–∞–≤–∫–∏ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    

> –ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö DAG –¥–æ–ª–∂–µ–Ω —É–≤–µ–¥–æ–º–ª—è—Ç—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ email –∏–ª–∏ Slack).

* * *

üß© –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
------------------------

    bank-analytics-platform/
    ‚îú‚îÄ‚îÄ dags/
    ‚îÇ   ‚îú‚îÄ‚îÄ clients_etl_dag.py
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îú‚îÄ‚îÄ sql/
    ‚îÇ   ‚îú‚îÄ‚îÄ create_clients_table.sql
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îú‚îÄ‚îÄ docs/
    ‚îÇ   ‚îú‚îÄ‚îÄ dashboard_screenshot.png
    ‚îÇ   ‚îî‚îÄ‚îÄ ...
    ‚îú‚îÄ‚îÄ docker-compose.yml
    ‚îî‚îÄ‚îÄ README.md
    

* * *

‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç
-----------

*   –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—â–∞—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
    
*   –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥—ã–µ 60 –º–∏–Ω—É—Ç
    
*   –î–∞—à–±–æ—Ä–¥ —Å –∞–∫—Ç—É–∞–ª—å–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π
    
*   –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –¥–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è —Å –Ω—É–ª—è
    

* * *

**–ê–≤—Ç–æ—Ä:** *<—Ç–≤–æ—ë –∏–º—è>*  
**–ö–æ–Ω—Ç–∞–∫—Ç:** *<–ø–æ—á—Ç–∞ –∏–ª–∏ –Ω–∏–∫>*  
**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:** PostgreSQL ¬∑ Airflow ¬∑ Superset ¬∑ Docker

    
